<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin</title>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"
          integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"
            integrity="sha256-JLmknTdUZeZZ267LP9qB+/DT7tvxOOKctSKeUC2KT6E=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="admin.css">
</head>
    
<body style="font-size: 16px">
    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        <!-- <img alt="shop.png" height="35" src="static/img/shop.png" /> -->
        <h5 class="my-0 mr-md-auto font-weight-normal"><a href="admin.html">Evaluation</a></h5>
        <a href="admin.html" class="btn btn-outline-primary">evaluation</a>
        <a href="admin_user.html" class="btn btn-outline-primary ml-3">user</a>
        <a href="admin_bannedList.html" class="btn btn-outline-primary ml-3">user banned</a>
        <a href="index.html" class="btn btn-outline-primary ml-3">admin</a>
    </div>

    <div id="content">

        <div id="evaList">
            <table v-if="hadContent">
                <thead>
                    <th>evaluation id</th>
                    <th>buyer id</th>
                    <th>buyer name</th>
                    <th>commodity id</th>
                    <th>commodity name</th>
                    <th>content</th>
                    <th>delete</th>
                    <!-- <th>ban user</th> -->
                    <!-- <th>status</th> -->
                </thead>
                <tbody v-for="o in list">
                    <td>{{o.evaluation_id}}</td>
                    <td>{{o.buyer_id}}</td>
                    <td>{{o.buyer_name}}</td>
                    <td>{{o.commodity_id}}</td>
                    <td>{{o.commodity_name}}</td>
                    <td>{{o.content}}</td>
                    <td>
                        <button id="delete" v-on:click="deleteItem(o.evaluation_id)">Delete</button>
                    </td>
                    
                </tbody>
            </table>
            <h1 id="noContent" v-else>Evaluation is empty!</h1>
        </div>
    </div>
    <!-- <div class="page-bar">
        <ul>
            <li v-if="cur>1"><a v-on:click="cur--,pageClick()">Previous</a></li>
            <li v-if="cur==1"><a class="banclick">Previous</a></li>
            <li v-for="index in indexs" v-bind:class="{ 'active': cur == index}">
                <a v-on:click="btnClick(index)">{{ index }}</a>
            </li>
            <li v-if="cur<all"><a v-on:click="cur++,pageClick()">Next</a></li>
            <li v-if="cur == all"><a class="banclick">Next</a></li>
            <li>
                <a>
                    Total
                    <i>{{ all }}</i>
                    pages
                </a>
            </li>
        </ul>
    </div> -->

        <footer class="pt-4 my-md-5 pt-md-5 border-top">
            <div class="row">
                <div class="col-12 col-md">
                    <h5>Copyright&copy;2021</h5>
                    <p>
                        <a target="_blank">
                            <i class="fa fa-leaf"></i>
                            Blog
                        </a>
                        -
                        <a target="_blank">
                            <i class="fa fa-github"></i>
                            Github
                        </a>
                        -
                        <a target="_blank">
                            <i class="fa fa-question"></i>
                            Help
                        </a>
                    </p>
                </div>
            </div>
        </footer>
    </div>
<script>
    new Vue({
            el: '#content',
            data(){
            return {
                defaultPagesize:10,
                hadContent: true,
                list:[
                    {
                        evaluation_id: 0,
                        buyer_id:0,
                        buyer_name: 'buyername',
                        commodity_id: 0,
                        commodity_name:'commodityname',
                        content:"content",
                    },
                    {
                        evaluation_id: 1,
                        buyer_id:1,
                        buyer_name: 'buyername',
                        commodity_id: 0,
                        commodity_name:'commodityname',
                        content:"content",
                    },
                    {
                        evaluation_id: 2,
                        buyer_id:0,
                        buyer_name: 'buyername',
                        commodity_id: 0,
                        commodity_name:'commodityname',
                        content:"content",
                    }
                ]}
            },
            methods:{
                deleteItem:function(eid){
                    const that = this
                    console.log(eid)
                    const token = window.localStorage.getItem("ishopping-token")
                    axios.defaults.headers.common = {Authorization:`${token}`}
                    axios({
                        method: 'post',
                        // url: api_url + '/seller/order_delivery',
                        url: "http://ishopping.gq/api/admin/delete_evaluation",
                        data:{
                            'evaluation_id':eid
                    }}).then(function(res){
                        console.log(that.list)
                        if(res.data.code == 0){
                            that.list.some((item,i)=>{
                                if(item.evaluation_id == eid){
                                    that.list.splice(i,1)
                                    return true
                                }
                            })
                        }else{
                            console.log(res.data.msg)
                        }
                    })
                    .catch(function (error) { 
                        console.log(error);
                    })
                },
                getItems:function(page){
                    const that = this
                    const token = window.localStorage.getItem("ishopping-token")
                    axios.defaults.headers.common = {Authorization:`${token}`}
                    axios({
                        // url: api_url + '/seller/order_list?order_status=1',
                        url: `"http://ishopping.gq/api/admin/evaluation_list?page=${page}&page_size=${that.defaultPagesize}"`,
                        method: 'get',
                    })
                        .then(function(res){
                            that.hasOrder = true
                            if(res.data.code == 0){
                                console.log(res.data.data.evaluation_list)
                                for(let i in res.data.data.evaluation_lsit){
                                    list.push(res.data.data.evaluation_list[i])
                                }
                                
                            }else{
                                console.log(res.data.msg)
                            }
                            
                        })
                    .catch(function (error) { 
                        console.log(error)
                    });
                },
                banUser:function(uid,shopName){

                }

            },
            mounted(){
                const that = this

                const token = window.localStorage.getItem("ishopping-token")
                axios.defaults.headers.common = {Authorization:`${token}`}
                axios({
                    // url: api_url + '/seller/order_list?order_status=1',
                    url: `"http://ishopping.gq/api/admin/evaluation_list?page=5&page_size=${that.defaultPagesize}"`,
                    method: 'get',
                })
                    .then(function(res){
                        that.hasContent = true
                        if(res.data.code == 0){
                            list=res.data.data.evaluation_list
                        }else{
                            console.log(res.data.msg)
                        }
                        if(true){

                        }else if(true){

                        }else{
                            
                        }
                    })
                    .catch(function (error) { 
                        console.log(error)
                    });
                
            },
        })
</script>
<style>
    table{
        margin:auto;
        border:2px solid black;
        text-align: center;
        font-size: 22px;
        width:1000px
    }
    tbody{
        font-size:20px;
    }
    th,td{
        border:1px solid black;
    }
</style>
</body>
</html>