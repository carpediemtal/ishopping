<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Commodity Detail</title>
        <link rel="shortcut icon" href="static/icon/icon.jpg" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
            integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
            crossorigin="anonymous"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"
        ></script>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"
            integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0="
            crossorigin="anonymous"
        />
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script
            src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"
            integrity="sha256-JLmknTdUZeZZ267LP9qB+/DT7tvxOOKctSKeUC2KT6E="
            crossorigin="anonymous"
        ></script>
    </head>
    <body>
        <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
            <img alt="shop.png" height="35" src="static/icon/shop.png" />
            <h5 class="my-0 mr-md-auto font-weight-normal"><a href="index.html">ISHOPPING</a></h5>
            <a href="index.html" class="btn btn-outline-primary">Home</a>
        </div>

        <div class="container" id="container">
            <div class="row">
                <div class="col">
                    <img :src="detail.thumbnail" alt="thumbnail" />
                </div>
                <div class="col">
                    <div>
                        <p>Commodity Name: {{ detail.name }}</p>
                        <p>Inventory: {{ detail.inventory }}</p>
                        <p>Sales: {{ detail.sales }}</p>
                        <p>Price: {{ detail.price }}</p>
                    </div>

                    <div class="mt-5">
                        <button class="btn btn-primary" @click="jumpToPurchase">Purchase</button>
                        <!-- <button class="btn btn-info ml-3">Add to Cart</button> -->
                    </div>
                </div>
            </div>

            <div class="mt-5">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a
                            class="nav-link active"
                            id="introduction-tab"
                            data-toggle="tab"
                            href="#introduction"
                            role="tab"
                            aria-controls="introduction"
                            aria-selected="true"
                        >
                            Introduction
                        </a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="images-tab" data-toggle="tab" href="#images" role="tab" aria-controls="profile" aria-selected="false">
                            Images
                        </a>
                    </li>
                </ul>

                <div class="tab-content mt-4" id="myTabContent">
                    <div class="tab-pane fade show active" id="introduction" role="tabpanel" aria-labelledby="introduction-tab">
                        <p>{{ detail.introduction }}</p>
                    </div>
                    <div class="tab-pane fade" id="images" role="tabpanel" aria-labelledby="images-tab">
                        <div v-for="image in detail.images">
                            <img class="mt-4" v-bind:src="image" alt="ALT" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>

    <script src="static/js/common.js"></script>
    <script>
        const app = new Vue({
            el: "#container",
            data: {
                detail: {
                    name: "commodity name",
                    inventory: "inventory",
                    sales: "sales",
                    price: "price",
                    introduction:
                        "Placeholder content for the tab panel. This one relates to the home tab. Takes you miles high, so high, 'cause she’s got that one international smile. There's a stranger in my bed, there's a pounding in my head. Oh, no. In another life I would make you stay. ‘Cause I, I’m capable of anything. Suiting up for my crowning battle. Used to steal your parents' liquor and climb to the roof. Tone, tan fit and ready, turn it up cause its gettin' heavy. Her love is like a drug. I guess that I forgot I had a choice.",
                    thumbnail: "http://ww1.sinaimg.cn/large/005VT09Qly1gqaqpj8yi1j306o06omxh.jpg",
                    images: [
                        "http://ww1.sinaimg.cn/large/005VT09Qly1gqaqpj8yi1j306o06omxh.jpg",
                        "http://ww1.sinaimg.cn/large/005VT09Qly1gqaqpj8yi1j306o06omxh.jpg",
                        "http://ww1.sinaimg.cn/large/005VT09Qly1gqaqpj8yi1j306o06omxh.jpg",
                    ],
                },
            },
            created: function () {
                let url = new URL(window.location.href)
                const cid = url.searchParams.has("cid") ? parseInt(url.searchParams.get("cid")) : 0

                const that = this
                axios({
                    method: "get",
                    url: `${api_url}/commodity_detail?cid=${cid}`,
                })
                    .then(function (resp) {
                        if (resp.data.code === 0) {
                            that.detail = resp.data.data
                        } else {
                            alert("commodity not found:" + resp.data.msg)
                        }
                    })
                    .catch(function (resp) {
                        console.log(resp)
                        alert(resp.data.msg)
                    })
            },
            methods: {
                jumpToPurchase: function () {
                    console.log(cid)
                    window.location.replace("./buyer/confirm_purchase.html?commodity_id=" + cid)
                },
            },
        })
    </script>
</html>
