<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin</title>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"
          integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"
            integrity="sha256-JLmknTdUZeZZ267LP9qB+/DT7tvxOOKctSKeUC2KT6E=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="admin.css">
</head>
    
<body style="font-size: 16px" id="evaluation">
    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        <h5 class="my-0 mr-md-auto font-weight-normal"><a href="admin.html">Banned List</a></h5>
        <a href="admin.html" class="btn btn-outline-primary">evaluation</a>
        <a href="admin_user.html" class="btn btn-outline-primary ml-3">user</a>
        <a href="admin_bannedList.html" class="btn btn-outline-primary ml-3">user banned</a>
        <a href="index.html" class="btn btn-outline-primary ml-3">admin</a>
    </div>
    
    <div id="banContent">
       
        <div id="evaList">
            <table >
                <thead>
                    <th>user id</th>
                    <th>name</th>
                    <th>ban</th>
                    <!-- <th>status</th> -->
                </thead>
                <tbody v-for="o in list">
                    <td>{{o.user_id}}</td>
                    <td>{{o.name}}</td>
                    
                    <td>
                        <button id="ban" v-on:click="unBanFun(o.user_id)">Unban</button>
                    </td>
                </tbody>
            </table>
        </div>
    </div>
    

    <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
            <div class="col-12 col-md">
                <h5>Copyright&copy;2021</h5>
                <p>
                    <a target="_blank">
                        <i class="fa fa-leaf"></i>
                        Blog
                    </a>
                    -
                    <a target="_blank">
                        <i class="fa fa-github"></i>
                        Github
                    </a>
                    -
                    <a target="_blank">
                        <i class="fa fa-question"></i>
                        Help
                    </a>
                </p>
            </div>
        </div>
    </footer>
    </div>
<script>
    new Vue({
            el: '#banContent',
            data(){
            return {
                searchContent:'',
                list:[
                    {
                        user_id:0,
                        name:'123',
                        banned:true
                    },
                    {
                        user_id:1,
                        name:'111',
                        banned:true
                    }
                ]}
            },
            methods:{
                unBanFun:function(id){
                    console.log(id)
                    const that = this
                    const token = window.localStorage.getItem("ishopping-token")
                    axios.defaults.headers.common = {Authorization:`${token}`}
                    axios({
                        method: 'post',
                        // url: api_url + '',
                        url:"http://ishopping.gq/api/admin/unban",
                        data:{
                            user_id:id
                        }
                    }).then(function(res){
                        if(res.data.code == 0){
                            that.list.some((item,i)=>{
                                if(item.user_id == id){
                                    that.list.splice(i,1)
                                    return true
                                }
                            })
                        }else{
                            console.log(res.data.msg)
                        }
                    })
                    .catch(function (error) { 
                        console.log(error);
                    })
                }
            },
            mounted(){
                const that = this
                const token = window.localStorage.getItem("ishopping-token")
                axios.defaults.headers.common = {Authorization:`${token}`}
                axios({
                    method: 'get',
                    // url: api_url + '',
                    url: `"http://ishopping.gq/api/admin/banned_user_list?page=5&page_size=${10}"`,
                }).then(function(res){
                    if(res.data.code == 0){
                        // for(let i in res.data.data.list){
                        //     res.data.data.list[i].banned = true
                        //     that.list.push(res.data.data.list[i])
                        // }
                        that.list=res.data.data.list
                    }else{
                        console.log(res.data.msg)
                    }
                })
                .catch(function (error) { 
                    console.log(error);
                })
            }
        })
</script>
<style>
    table{
        margin:auto;
        border:2px solid black;
        text-align: center;
        font-size: 22px;
        width:1000px
    }
    tbody{
        font-size:20px;
    }
    th,td{
        border:1px solid black;
    }
</style>
</body>
</html>